---
title: "Research project 1"
author: "Manuel Estevez R"
date: "09/06/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Load and Explore/process the data

```{r}
actividades<-read.csv("data_activity/activity.csv")
dim(actividades)
names(actividades)
head(actividades)
str(actividades)
sum(is.na(actividades$steps))/dim(actividades)[[1]]
library(lubridate)
actividades$date<-ymd(actividades$date)
length(unique(actividades$date))
```

## Histogram of the total number of steps taken each day
1. Calculate the total number of steps taken per day<br>
2. Make a histogram of the total number of steps taken each day<br>
3. Calculate and report the mean and median total number of steps taken per day<br>
```{r}
pasospordias<-aggregate(actividades$steps,list(actividades$date), FUN=sum)
colnames(pasospordias)<-c("Date","Steps")
pasospordias
```
Histogram
```{r}
hist(pasospordias$Steps, main = "Total number of steps taken per day", xlab = "Total steps taken per day", col = "green", ylim = c(0,20), breaks = seq(0,25000, by=2500))

```

# Mean and Median
```{r}
media<-mean(pasospordias$Steps, na.rm=TRUE)
media
mediana<-median(pasospordias$Steps, na.rm=TRUE)
mediana
```

## Average daily activity pattern 
1. Make a time series plot (i.e type= “𝚕”) of the 5-minute interval (x-axis) and the average number of steps taken, averaged across all days (y-axis)<br>
2. Which 5-minute interval, on average across all the days in the dataset, contains the maximum number of steps?<br>
```{r}

promedioactividad<-aggregate(actividades$steps, by = list(actividades$interval), FUN=mean, na.rm=TRUE )
names(promedioactividad) <- c("Interval", "Mean")
plot(promedioactividad$Interval, promedioactividad$Mean, type = "l", col="black", lwd = 2, xlab="Interval", ylab="Average number of steps", main="1. Average number of steps per intervals")

intervalmax<-promedioactividad[which.max(promedioactividad$Mean), ]$Interval
intervalmax

      

